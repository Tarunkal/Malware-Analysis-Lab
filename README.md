# Malware-Analysis-Lab

## Objective

To demonstrate the creation of a comprehensive cybersecurity home lab utilizing VMware technology to execute over 20 malware experiments, aimed at enhancing malware detection and analysis capabilities. This project involves the thorough analysis of system events, which led to the identification of 100+ malware variants. The insights gained were applied to optimize countermeasures and strengthen the security protocols designed for improved threat defense. The goal is to showcase advanced skills in malware analysis, virtual lab environment configuration, and the development of effective security strategies.

### Skills Learned

- Proficient in setting up and configuring virtual environments using VMware for cybersecurity testing.
- Advanced skills in malware analysis and reverse engineering of 20+ malware samples.
- Ability to conduct thorough event analysis, identifying 100+ malware variants and behavioral patterns.
- Expertise in optimizing security protocols and countermeasures based on experimental findings.
- Enhanced critical thinking and problem-solving abilities in identifying and mitigating malware threats.
  
### Tools Used


- VMware for creating and managing isolated virtual environments for malware testing.
- PE Studio for static malware analysis and identifying malicious indicators.
- Procmon for real-time event monitoring and behavioral analysis of malware.
- Wireshark for capturing and analyzing network traffic generated by malware.
- Sysmon for advanced event logging and tracking of malware activities in the virtual environment.


![Image](https://github.com/user-attachments/assets/15f5f6fb-5906-44b7-9f3b-20a01f939aa1)

![Image](https://github.com/user-attachments/assets/8154e37a-a1ab-4608-8ece-663d8360b9be)




MITRE ATT&CT Mapping
Here is the MITRE ATT&CK mapping organized in a table format:

| **Tactic**                  | **Technique**              | **Description**                                                                 |
|-----------------------------|----------------------------|---------------------------------------------------------------------------------|
| **Execution**                | **TA0002** Command and Scripting Interpreter | Executes commands using a command-line interface.                         |
|                             | **T1059** Very long cmdline option found (may be encrypted or packed)  | Uncommon command-line options, potentially encrypted or packed.           |
|                             | **Shared Modules**        | Executes malicious payloads via loading shared modules.                      |
| **Persistence**              | **TA0003** Create or Modify System Process | Modifies system processes to establish persistence.                        |
|                             | **T1543** Windows Service                                            | Creates or modifies Windows services.                                       |
|                             | **T1543.003** Creates a software uninstall entry                     | Adds software uninstall entries.                                            |
|                             | **Boot or Logon Autostart Execution** | Establishes persistence via boot/logon mechanisms.                        |
|                             | **T1547** Registry Run Keys / Startup Folder                        | Uses startup directories and registry keys for autostart.                  |
|                             | **T1547.001** Stores files to the Windows startup directory         | Stores executable files for automatic execution.                          |
|                             | **Hijack Execution Flow**  | Hijacks execution flow through DLL search order hijacking.                |
|                             | **T1574** DLL Search Order Hijacking                               | Uses vulnerabilities to load libraries and bypass standard loading paths. |
|                             | **T1574.001** EXE hyjacking vulnerability found                     | Exploits EXE hijacking vulnerabilities.                                    |
|                             | **T1574.002** DLL Side-Loading                                     | Loads missing DLLs via DLL side-loading.                                   |
| **Privilege Escalation**     | **TA0004** Process Injection                                       | Injects malicious code into processes to escalate privileges.             |
|                             | **T1055** Detects Windows Explorer process for injection            | Identifies Windows Explorer for process injection.                        |
|                             | **Create or Modify System Process** | Creates or modifies system processes to escalate privileges.             |
|                             | **Boot or Logon Autostart Execution** | Utilizes boot/logon mechanisms for persistence.                         |
|                             | **Hijack Execution Flow**  | Hijacks execution flow through various methods.                          |
| **Defense Evasion**          | **TA0005** Obfuscated Files or Information                         | Evades detection through file and information obfuscation.                |
|                             | **T1027** Software Packing                                         | Applies software packing to conceal malicious code.                      |
|                             | **T1036** Masquerading                                             | Uses non-matching file extensions and user directory placements.          |
|                             | **System Binary Proxy Execution** | Bypasses defenses using binary proxy execution.                       |
|                             | **T1218** Regsvr32                                                   | Registers DLLs through legitimate utilities to execute malicious code.    |
|                             | **Virtualization/Sandbox Evasion** | Evades detection in virtualized environments through various techniques.  |
| **Credential Access**        | **TA0006** Input Capture                                           | Captures user credentials through input capture mechanisms.               |
|                             | **T1056** Logs and monitors keystrokes                             | Monitors and logs user keystrokes.                                       |
|                             | **Discovery**           | **TA0007** Application Window Discovery                             | Discovers running applications and monitors window changes.               |
|                             | **T1010** Monitors Window changes                                  | Tracks changes in windows (e.g., launching applications).                 |
|                             | **Query Registry**      | **T1012** Monitors certain registry keys/values                       | Watches registry key/value changes.                                      |
|                             | **Remote System Discovery** | **T1018** Reads the hosts file                                     | Reads system-related files to gather information.                        |
|                             | **Process Discovery**   | **T1057** Detects Windows Explorer process                          | Identifies processes for potential injection.                            |
|                             | **System Information Discovery** | **T1082** Queries cryptographic machine GUID                   | Retrieves system-level information.                                     |
|                             | **File and Directory Discovery** | **T1083** Enumerates the file system                               | Explores file systems for information gathering.                         |
| **Collection**              | **TA0009** Input Capture                                           | Captures user input for analysis or further malicious activities.        |
|                             | **Command and Control**   | **TA0011** Application Layer Protocol                              | Communicates over application layer protocols for blending in traffic.   |



